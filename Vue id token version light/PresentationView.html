<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <title>NEXUS - Identity</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- ZOOM WRAPPER -->
  <div id="zoom-wrapper">
    <div class="id-card-container">
      <!-- FRONT -->
      <div class="id-card-front">

        <div class="top-row">
          <div class="logo-area"><span class="company-name">ID Token</span></div>
          <div class="chip">
            <svg width="40px" height="40px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path fill="var(--primary)"
                d="M16.0527864,12.7236068 C15.1346811,10.8873961 13.8035869,10 12,10 C10.1964131,10 8.86531893,10.8873961 7.9472136,12.7236068 C7.82371897,12.970596 7.52338245,13.0707082 7.2763932,12.9472136 C7.02940395,12.823719 6.92929178,12.5233825 7.0527864,12.2763932 C8.13468107,10.1126039 9.80358687,9 12,9 C14.1964131,9 15.8653189,10.1126039 16.9472136,12.2763932 C17.0707082,12.5233825 16.970596,12.823719 16.7236068,12.9472136 C16.4766175,13.0707082 16.176281,12.970596 16.0527864,12.7236068 Z M16,12 L16,9.5 C16,9.22385763 16.2238576,9 16.5,9 C16.7761424,9 17,9.22385763 17,9.5 L17,12.5 C17,12.7761424 16.7761424,13 16.5,13 L13.5,13 C13.2238576,13 13,12.7761424 13,12.5 C13,12.2238576 13.2238576,12 13.5,12 L16,12 Z M18.5,3 C19.8807119,3 21,4.11928813 21,5.5 C21,5.77614237 20.7761424,6 20.5,6 C20.2238576,6 20,5.77614237 20,5.5 C20,4.67157288 19.3284271,4 18.5,4 C18.2238576,4 18,3.77614237 18,3.5 C18,3.22385763 18.2238576,3 18.5,3 Z M16.5,4 L14.5,4 C14.2238576,4 14,3.77614237 14,3.5 C14,3.22385763 14.2238576,3 14.5,3 L16.5,3 C16.7761424,3 17,3.22385763 17,3.5 C17,3.77614237 16.7761424,4 16.5,4 Z M21,8.5 L21,10.5 C21,10.7761424 20.7761424,11 20.5,11 C20.2238576,11 20,10.7761424 20,10.5 L20,8.5 C20,8.22385763 20.2238576,8 20.5,8 C20.7761424,8 21,8.22385763 21,8.5 Z M21,13.5 L21,15.5 C21,15.7761424 20.7761424,16 20.5,16 C20.2238576,16 20,15.7761424 20,15.5 L20,13.5 C20,13.2238576 20.2238576,13 20.5,13 C20.7761424,13 21,13.2238576 21,13.5 Z M21,18.5 C21,19.8807119 19.8807119,21 18.5,21 C18.2238576,21 18,20.7761424 18,20.5 C18,20.2238576 18.2238576,20 18.5,20 C19.3284271,20 20,19.3284271 20,18.5 C20,18.2238576 20.2238576,18 20.5,18 C20.7761424,18 21,18.2238576 21,18.5 Z M16.5,21 L14.5,21 C14.2238576,21 14,20.7761424 14,20.5 C14,20.2238576 14.2238576,20 14.5,20 L16.5,20 C16.7761424,20 17,20.2238576 17,20.5 C17,20.7761424 16.7761424,21 16.5,21 Z M12,2.5 L12,6.5 C12,6.77614237 11.7761424,7 11.5,7 C11.2238576,7 11,6.77614237 11,6.5 L11,2.5 C11,2.22385763 11.2238576,2 11.5,2 C11.7761424,2 12,2.22385763 12,2.5 Z M12,14.5 L12,21.5 C12,21.7761424 11.7761424,22 11.5,22 C11.2238576,22 11,21.7761424 11,21.5 L11,14.5 C11,14.2238576 11.2238576,14 11.5,14 C11.7761424,14 12,14.2238576 12,14.5 Z M8.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L8.5,20 C8.77614237,20 9,20.2238576 9,20.5 C9,20.7761424 8.77614237,21 8.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L8.5,3 C8.77614237,3 9,3.22385763 9,3.5 C9,3.77614237 8.77614237,4 8.5,4 Z" />
            </svg>
          </div>
        </div>

        <!-- PHOTO AREA -->
        <div class="photo-area">
          <img class="agent-photo" src="https://randomuser.me/api/portraits/women/44.jpg" alt="Agent Photo">
        </div>

        <!-- NAME (Moved OUT of details) -->
        <div class="name-text-wrapper">
          <h2 class="name">Sarah Connor Sarah Connor Sarah Connor Sarah Connor Sarah Connor Sarah Connor</h2>
        </div>

        <!-- DETAILS -->
        <div class="details">
          <span class="rank">ID Document data</span>
          <div class="data-grid">
            <div><span class="data-label">TYPE</span><span class="data-val">P</span></div>
            <div><span class="data-label">ISSUER</span><span class="data-val">USA</span></div>
            <div><span class="data-label">NATIONALITY</span><span class="data-val">American</span></div>
            <div><span class="data-label">GENDER</span><span class="data-val">F</span></div>
            <div><span class="data-label">BIRTH DATE</span><span class="data-val">12/2029</span></div>
            <div><span class="data-label">PLACE</span><span class="data-val">Chicago</span></div>
            <div><span class="data-label">ISSUED</span><span class="data-val">2022-12-31</span></div>
            <!-- USE ISO DATE FORMAT FOR JS COMPATIBILITY -->
            <div><span class="data-label">EXPIRES</span><span id="expiry-date" class="data-val">2030-12-22</span></div>
          </div>
        </div>

        <div class="bottom-id">&gt;&gt; 8473 9283 1102 &lt;&lt;</div>
      </div>
    </div>
  </div>

  <!-- FLOATING ZOOM BUTTON -->
  <div class="button-div"><button id="zoom-btn" class="glass-btn-icon">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7" />
      </svg>
    </button></div>

  <script>
    // ==========================================
    // 1. GLOBAL VARIABLES
    // ==========================================
    let card, zoomBtn, zoomWrapper;
    let isZoomed = false;

    // ==========================================
    // 2. HELPER FUNCTIONS
    // ==========================================

    function checkExpiration() {
      const expiryElement = document.getElementById('expiry-date');
      if (!expiryElement) return;
      // Parse text like "2026-12-22"
      const dateString = expiryElement.innerText.trim();
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      if (today > new Date(dateString)) {
        document.documentElement.style.setProperty('--accent', '#ff0064');
        document.documentElement.style.setProperty('--primary', '#ff0064');
        const container = document.querySelector('.id-card-container');
        if (container) container.style.boxShadow = "0 15px 35px rgba(0, 0, 0, 0.6), 0 0 15px rgba(255, 0, 100, 0.5)";
      }
    }

    function adjustNameFontSize() {
      // Logic moved to CSS (Clamping), this just cleans inline styles
      const nameElement = document.querySelector('.name');
      if (!nameElement) return;
      nameElement.style.fontSize = '';
      nameElement.style.whiteSpace = '';
      nameElement.style.lineHeight = '';
    }

    // --- FULLSCREEN & ZOOM ---
    function enterFullscreen() {
      const elem = document.documentElement;
      try {
        if (elem.requestFullscreen) elem.requestFullscreen().catch(() => { });
        else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
      } catch (e) { }
    }

    function exitFullscreen() {
      try {
        if (document.exitFullscreen) document.exitFullscreen().catch(() => { });
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      } catch (e) { }
    }

    function updateZoomScale() {
      if (!isZoomed || !zoomWrapper) {
        if (zoomWrapper) zoomWrapper.style.transform = 'scale(1)';
        return;
      }

      setTimeout(() => {
        if (!card) return;
        const baseW = card.offsetWidth;
        const baseH = card.offsetHeight;
        const margin = 10;

        const availableWidth = window.innerWidth - (margin * 2);
        const availableHeight = window.innerHeight - (margin * 2);

        const scaleX = availableWidth / baseW;
        const scaleY = availableHeight / baseH;
        const scaleFactor = Math.min(scaleX, scaleY);

        zoomWrapper.style.transform = `scale(${scaleFactor})`;
      }, 100);
    }

    function toggleZoom() {
      isZoomed = !isZoomed;

      if (isZoomed) {
        document.body.classList.add('is-zoomed');
        enterFullscreen();
        updateZoomScale();
        zoomBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>`;
      } else {
        document.body.classList.remove('is-zoomed');
        exitFullscreen();
        updateZoomScale();
        zoomBtn.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7" /></svg>`;
      }
    }

    // ==========================================
    // 3. MAIN INITIALIZATION (Wait for DOM)
    // ==========================================
    window.addEventListener('DOMContentLoaded', () => {

      // A. Assign DOM Elements
      card = document.querySelector('.id-card-container');
      zoomBtn = document.getElementById('zoom-btn');
      zoomWrapper = document.getElementById('zoom-wrapper');

      // B. Basic Checks
      checkExpiration();
      adjustNameFontSize();

      // C. Event Listeners (UI)
      zoomBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleZoom();
      });
    });

    // ==========================================
    // 4. GLOBAL WINDOW EVENTS
    // ==========================================
    let resizeTimer;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(adjustNameFontSize, 200);
      if (isZoomed) updateZoomScale();
    });

  </script>
</body>

</html>